{"name":"Rpcsniffer","tagline":"RPCSniffer sniffs WINDOWS RPC messages in a given RPC server process.","body":"RPCSniffer\r\n==========\r\nRPCSniffer sniffs RPC messages in a given RPC server process.\r\n\r\n![sniffing example in spoolsv process](https://raw.githubusercontent.com/AdiKo/RPCSniffer/master/sample_screenshot.png)\r\n\r\nGeneral Information\r\n-------------------\r\nWith RPCSniffer you can explore RPC Messages that present on Microsoft system.\r\n    The data given for each RPC message contains the following details:\r\n* Type (Async/Sync , Request/Response)\r\n* Process number\r\n* Thread number\r\n* Procedure number\r\n* Transfer Info\r\n    * GUID\r\n\t* RPC minor version\r\n\t* RPC major version\r\n* Interface Info\r\n\t* GUID\r\n\t* Dispatch table pointer\r\n\t* Dispatch table size\r\n\t* Dispatch table function pointer\r\n* Midl Info\r\n    * Dispatch pointer\r\n    * Server function address\r\n* RPC Flags\r\n* RPC Data\r\n\r\n\r\n## Install steps\r\n\r\n1. Install [python 2.7](https://www.python.org/download/releases/2.7/) (64 bit)\r\n\r\n2. Install the latest [Winappdbg](http://winappdbg.sourceforge.net/) python package\r\n\r\n3. Install [Wireshark](https://www.wireshark.org/download.html)\r\n\r\n4. Intsall the latest [Pyreshark](https://github.com/ashdnazg/pyreshark) python module for wireshark\r\n\r\n5. grab the file _\"pyreshark_rpc_dissector/rpc_protocol.py\"_ to _\"c:\\Program Files\\Wireshark\\python\\protocols\\\"_\r\n\r\n## Run\r\n\r\n1. Start Wireshark from cmd and prepare it to use rpcsniffer's pipe\r\n\r\n```\r\n\t\"C:\\Program Files\\Wireshark\\Wireshark.exe\" -i \\\\.\\pipe\\RPCSniffer\r\n```\r\n\r\n2. Run python main.py with the server process to listen\r\n    \r\n```\r\n    python main.py --help\r\n    usage: main.py [-h] (-p PID | -n PROCNAME)\r\n    main.py: error: one of the arguments -p/--pid -n/--procname is required\r\n ```\r\n    \r\n3. go back to wireshark and click \"start\"\r\n4. from now you'll get all rpc messages in wireshark\r\n\r\n## Implementation\r\n\r\nCheck the wiki for more info.\r\n\r\n\r\n## TODO\r\n\r\n\t\r\nThis project is a POC for now, but you can help me add some stunning features that will allow us to really understand RPC internals. \r\n- Dissect the rpc raw data (maybe by using the RPCView decompiler and find a MIDL-dissector?)\r\n- Integrate it with the wireshark midl-dissector itself\r\n- Retreive more data from the rpc message (I used [REACTOS](https://www.reactos.org/) to parse the RPC MESSAGE). Can you find more usefull data from this windows struct?\r\n\r\n\r\nAnyway, I'd be more than happy to receive bug reports, suggestions and anything else.\r\n\r\n\r\n## Some Comments\r\n\r\n- It's very usefull to use the powerful and free tool called RPCView for finding interesting RPC server processes, decompile its interfaces and more. Take a look at\r\n\thttp://rpcview.org/index.html\r\n\r\n\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}